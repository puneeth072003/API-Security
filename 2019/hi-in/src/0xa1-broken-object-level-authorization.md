API1: 2019 टूटी वस्तु स्तर प्राधिकरण
==============================================

| थ्रेट एजेंट/अटैक वैक्टर | सुरक्षा कमजोरियां | प्रभाव |
| - | - | - |
| एपीआई विशिष्ट: शोषण क्षमता **3** | व्यापकता **3** : पता लगाने की क्षमता **2** | तकनीकी **3** : व्यापार विशिष्ट |
| हमलावर एपीआई एंडपॉइंट्स का फायदा उठा सकते हैं जो अनुरोध के भीतर भेजे गए ऑब्जेक्ट की आईडी में हेरफेर करके टूटे हुए ऑब्जेक्ट लेवल ऑथराइजेशन के लिए असुरक्षित हैं। इससे संवेदनशील डेटा तक अनधिकृत पहुंच हो सकती है। यह समस्या एपीआई-आधारित अनुप्रयोगों में बेहद आम है क्योंकि सर्वर घटक आमतौर पर क्लाइंट के राज्य को पूरी तरह से ट्रैक नहीं करता है, और इसके बजाय, ऑब्जेक्ट आईडी जैसे पैरामीटर पर अधिक निर्भर करता है, जो क्लाइंट से भेजे जाने वाले ऑब्जेक्ट्स को तय करने के लिए भेजा जाता है। | यह एपीआई पर सबसे आम और प्रभावशाली हमला रहा है। आधुनिक अनुप्रयोगों में प्राधिकरण और अभिगम नियंत्रण तंत्र जटिल और व्यापक हैं। भले ही एप्लिकेशन प्राधिकरण जांच के लिए उचित आधारभूत संरचना लागू करता है, फिर भी डेवलपर्स संवेदनशील वस्तु तक पहुंचने से पहले इन चेकों का उपयोग करना भूल सकते हैं। एक्सेस कंट्रोल डिटेक्शन आमतौर पर स्वचालित स्थिर या गतिशील परीक्षण के लिए उत्तरदायी नहीं है। | अनधिकृत पहुंच के परिणामस्वरूप अनधिकृत पार्टियों के लिए डेटा प्रकटीकरण, डेटा हानि या डेटा हेरफेर हो सकता है। वस्तुओं तक अनधिकृत पहुंच भी पूर्ण खाता अधिग्रहण का कारण बन सकती है। |

## क्या एपीआई कमजोर है?

ऑब्जेक्ट लेवल ऑथराइजेशन एक एक्सेस कंट्रोल मैकेनिज्म है जो आमतौर पर होता है
यह मान्य करने के लिए कोड स्तर पर लागू किया गया है कि एक उपयोगकर्ता केवल वस्तुओं तक ही पहुँच सकता है
कि उनकी पहुंच होनी चाहिए।

प्रत्येक एपीआई समापन बिंदु जो किसी वस्तु की एक आईडी प्राप्त करता है और किसी भी प्रकार का प्रदर्शन करता है
वस्तु पर कार्रवाई, वस्तु स्तर प्राधिकरण जांच लागू करनी चाहिए।
जांचों को सत्यापित करना चाहिए कि लॉग-इन उपयोगकर्ता के पास प्रदर्शन करने की पहुंच है
अनुरोधित वस्तु पर कार्रवाई का अनुरोध किया।

इस तंत्र में विफलता आम तौर पर अनधिकृत जानकारी की ओर ले जाती है
सभी डेटा का प्रकटीकरण, संशोधन या विनाश।

## उदाहरण हमले के परिदृश्य

### परिद्रश्य 1

ऑनलाइन स्टोर (दुकानों) के लिए एक ई-कॉमर्स प्लेटफॉर्म एक लिस्टिंग पेज प्रदान करता है
उनकी होस्ट की गई दुकानों के लिए राजस्व चार्ट। ब्राउज़र अनुरोधों का निरीक्षण, ए
हमलावर उन चार्ट के लिए डेटा स्रोत के रूप में उपयोग किए जाने वाले एपीआई एंडपॉइंट की पहचान कर सकता है
और उनका पैटर्न `/shops/{shopName}/revenue_data.json`। दूसरे एपीआई का उपयोग करना
समापन बिंदु, हमलावर सभी होस्ट किए गए स्टोर नामों की सूची प्राप्त कर सकता है। एक साधारण के साथ
सूची में नामों में हेरफेर करने के लिए स्क्रिप्ट, URL में `{shopName}` की जगह,
हमलावर हजारों ई-कॉमर्स स्टोर्स के बिक्री डेटा तक पहुंच प्राप्त करता है।

### परिदृश्य #2

पहनने योग्य डिवाइस के नेटवर्क ट्रैफ़िक की निगरानी करते समय, निम्न HTTP
`PATCH` अनुरोध किसकी उपस्थिति के कारण एक हमलावर का ध्यान आकर्षित करता है
कस्टम HTTP अनुरोध शीर्षलेख `एक्स-उपयोगकर्ता-आईडी: 54796`। `X-User-Id` मान को बदलना
`54795` के साथ, हमलावर को एक सफल HTTP प्रतिसाद प्राप्त होता है, और वह ऐसा करने में सक्षम होता है
अन्य उपयोगकर्ताओं के खाता डेटा को संशोधित करें।

## कैसे बचाना है

* एक उचित प्राधिकरण तंत्र लागू करें जो उपयोगकर्ता नीतियों पर निर्भर करता है
  और पदानुक्रम।
* लॉग-इन उपयोगकर्ता के पास पहुंच है या नहीं, यह जांचने के लिए एक प्राधिकरण तंत्र का उपयोग करें
  a का उपयोग करने वाले प्रत्येक फ़ंक्शन में रिकॉर्ड पर अनुरोधित क्रिया निष्पादित करें
  डेटाबेस में रिकॉर्ड तक पहुँचने के लिए क्लाइंट से इनपुट।
* रिकॉर्ड की आईडी के लिए GUID के रूप में यादृच्छिक और अप्रत्याशित मानों का उपयोग करना पसंद करें।
* प्राधिकरण तंत्र का मूल्यांकन करने के लिए परीक्षण लिखें। कमजोर तैनात न करें
  परिवर्तन जो परीक्षणों को तोड़ते हैं।

## संदर्भ

### बाहरी

* [सीडब्ल्यूई-284: अनुचित अभिगम नियंत्रण][1]
* [सीडब्ल्यूई-285: अनुचित प्राधिकरण][2]
* [CWE-639: प्राधिकरण बायपास उपयोगकर्ता-नियंत्रित कुंजी के माध्यम से][3]

[1]: https://cwe.mitre.org/data/definitions/284.html
[2]: https://cwe.mitre.org/data/definitions/285.html
[3]: https://cwe.mitre.org/data/definitions/639.html